# npm-audit-report-sonar-integration
Transform json file of audit report to a generic formatted issue report of sonar

# Requirements
* NPM v7 or upper version
* NPM lodash library
* NPM audit library

# Execution Example (Shell Script)
               transformerPath=.
               projectSrc=myproject_src
               projectName=myproject
               
               # Install lodash library
               npm i --save lodash

               echo "creating npm audit report (JSON) of the project: $project"
               cd $(myproject_src)
               npm audit --json > npm-audit-$projectName.json

               if [ ! -f npm-audit-$projectName.json ]; then
                 echo "npm-audit-$projectName.json was not generated"
                 exit 1
               fi

               cd ..
               
               # Transforming JSON to Sonar Generic Issue Import format
               echo "Transforming npm-audit-$projectName.json to Sonar Generic Issue Import format"
               jsonTransformerPath=$(transformerPath)/ctis-step-sonar-npm-front-transform-lodash.js
               dataTransformPath="$projectSrc/npm-audit-$projectName.json"
               node $jsonTransformerPath $dataTransformPath               

               if [ ! -f npm-audit-$projectName.json.transf ]; then
                 echo "npm-audit-$projectName.json.transf was not generated"
                 exit 1
               fi

               echo "npm-audit-$projectName.json.transf generated successfully"
               exit 0

# Incorporation to Sonar Qube
#    Adding parameter sonar.externalIssuesReportPaths with path of json file generated by transformer

sonar.externalIssuesReportPaths=./npm-audit-${{ parameters.projectName }}.json.transf
